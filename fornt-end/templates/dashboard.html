<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Admin Dashboard - Gi√°m s√°t tai n·∫°n</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <div class="brand">ADMIN QU·∫¢N L√ù</div>
            <nav class="menu" aria-label="Main">
                <button class="active" data-section="dashboard">üìä B·∫£ng ƒëi·ªÅu khi·ªÉn</button>
                <button data-section="map">üó∫Ô∏è B·∫£n ƒë·ªì tai n·∫°n</button>
                <button data-section="stats">üìà Th·ªëng k√™</button>
                <button data-section="reports">üìã Danh s√°ch b√°o c√°o</button>
                <button data-section="users">üë• Qu·∫£n l√Ω ng∆∞·ªùi d√πng</button>
                <button data-section="notif">üîî Th√¥ng b√°o</button>
            </nav>
            <div class="bottom">
                <button class="btn-alert" id="btnEmergency">üö®</button>
            </div>
        </aside>

        <main class="main">
            <header class="topbar">
                <div>
                    <div class="title">B·∫£ng ƒëi·ªÅu khi·ªÉn - Gi√°m s√°t tai n·∫°n giao th√¥ng</div>
                    <div style="color:var(--muted);font-size:13px">T·ªïng quan - Theo th·ªùi gian th·ª±c</div>
                </div>
                <div class="meta">
                    <div style="text-align:right">
                        <div style="font-weight:700">Xin ch√†o, Admin</div>
                        <div style="font-size:12px;color:var(--muted)">H√¥m nay: <span id="todayCount">0</span> v·ª•</div>
                    </div>
                    <div style="width:44px;height:44px;border-radius:999px;background:#e2e8f0;display:flex;align-items:center;justify-content:center">A</div>
                </div>
            </header>

            <section class="content-section active" id="dashboard-section">
                <section class="grid stats grid-4" aria-label="Statistics">
                    <div class="card">
                        <h4>T·ªïng v·ª• h√¥m nay</h4>
                        <div class="value" id="statTotal">0</div>
                        <div style="color:var(--muted);font-size:12px;margin-top:8px">C·∫≠p nh·∫≠t: <span id="statTime">v·ª´a xong</span></div>
                    </div>
                    <div class="card">
                        <h4>ƒêang x·ª≠ l√Ω</h4>
                        <div class="value" id="statProcessing">0</div>
                        <div style="height:8px"></div>
                    </div>
                    <div class="card">
                        <h4>ƒê√£ x·ª≠ l√Ω</h4>
                        <div class="value" id="statDone">0</div>
                        <div style="height:8px"></div>
                    </div>
                    <div class="card">
                        <h4>M·ª©c ƒë·ªô trung b√¨nh</h4>
                        <div class="value" id="statSeverity">0 / 5</div>
                    </div>
                </section>

                <div class="columns">
                    <div>
                        <div class="card" style="margin-bottom:14px">
                            <h3 style="margin:0 0 10px 0">Ho·∫°t ƒë·ªông theo gi·ªù</h3>
                            <div style="height:300px;">
                                <canvas id="lineChart"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <h3 style="margin:0 0 10px 0">T·ªâ l·ªá tr·∫°ng th√°i</h3>
                            <div style="height:260px;display:flex;align-items:center;justify-content:center">
                                <canvas id="pieChart" width="300" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    <aside>
                        <div class="card" style="margin-bottom:14px">
                            <h3 style="margin:0 0 8px 0">B·∫£n ƒë·ªì tai n·∫°n (preview)</h3>
                            <div id="map-preview" class="map-box"></div>
                        </div>
                        <div class="card">
                            <h3 style="margin:0 0 8px 0">H√†nh ƒë·ªông nhanh</h3>
                            <div style="display:flex;flex-direction:column;gap:8px">
                                <button style="padding:10px;border-radius:8px;border:0;background:var(--danger);color:white">B√°o c√°o kh·∫©n</button>
                                <button style="padding:10px;border-radius:8px;border:0;background:var(--warning);color:white">G·ª≠i c·∫£nh b√°o</button>
                                <button style="padding:10px;border-radius:8px;border:0;background:var(--success);color:white">ƒê√≥ng v·ª•</button>
                            </div>
                        </div>
                    </aside>
                </div>

                <section style="margin-top:18px">
                    <div class="card">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                            <h3 style="margin:0">B√°o c√°o m·ªõi nh·∫•t</h3>
                            <button id="view-all-reports" style="border:0;background:transparent;color:var(--purple-500);cursor:pointer">Xem t·∫•t c·∫£</button>
                        </div>
                        <div style="overflow:auto">
                            <table>
                                <thead>
                                    <tr>
                                        <th>M√£</th><th>Th·ªùi gian</th><th>Lo·∫°i</th><th>Khu v·ª±c</th><th>Tr·∫°ng th√°i</th><th>H√†nh ƒë·ªông</th>
                                    </tr>
                                </thead>
                                <tbody id="reportsTable">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </section>

            <section class="content-section" id="map-section">
                <div class="card">
                    <h3 style="margin:0">B·∫£n ƒë·ªì Tai n·∫°n</h3>
                    <div id="full-map" class="map-box mt-4" style="height: 600px;"></div>
                </div>
            </section>

            <section class="content-section" id="stats-section">
                </section>

            <section class="content-section" id="reports-section">
                <div class="card">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                        <h3 style="margin:0">T·∫•t c·∫£ b√°o c√°o</h3>
                    </div>
                    <div style="overflow:auto">
                        <table>
                            <thead>
                                <tr>
                                    <th>M√£</th><th>Th·ªùi gian</th><th>M√¥ t·∫£</th><th>Khu v·ª±c</th><th>Tr·∫°ng th√°i</th><th>H√†nh ƒë·ªông</th>
                                </tr>
                            </thead>
                            <tbody id="allReportsTable">
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section class="content-section" id="users-section">
                <div class="card">
                    <h3 style="margin:0">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h3>
                    <p style="color:var(--muted); margin-top: 8px;">N·ªôi dung qu·∫£n l√Ω ng∆∞·ªùi d√πng s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y.</p>
                </div>
            </section>

            <section class="content-section" id="notif-section">
                <div class="card">
                    <h3 style="margin:0">Th√¥ng b√°o</h3>
                    <p style="color:var(--muted); margin-top: 8px;">N·ªôi dung th√¥ng b√°o s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y.</p>
                </div>
            </section>
            
            <footer style="text-align:center;color:var(--muted);margin-top:18px">AN TO√ÄN GIAO TH√îNG - H·∫†NH PH√öC C·ª¶A M·ªåI NH√Ä</footer>
        </main>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>